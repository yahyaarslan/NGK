<!DOCTYPE html>
<html>

<head>
  <title>SWNGK WebClient</title>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.5.3/js/tabulator.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.5.3/css/tabulator.min.css">
  </link>

  <script type = "text/javascript">
    // *** LISTENER *** //
    // Note: Route Is chat
    const socket = new WebSocket("ws://localhost:8080/chat");

    socket.addEventListener("open", function (event) {
      // Sending a message to the web socket server...
      socket.send("Hello Server!");
    });

    // Listen for messages
    socket.addEventListener("message", function (message) {
      console.log("Message from server", message.data);
      document.getElementById("wsupdate").innerHTML = message.data;
    });
  </script>

  <script>
    // *** TABLE *** //
    function setTable(data) {
      $("#table").tabulator({
        layout: "fitDataFill",
        height: "311px",
        columns: [
          {
            title: "ID",
            field: "ID",
          },
          {
            title: "Date",
            field: "Date",
          },
          {
            title: "Time",
            field: "Time",
          },
          {
            title: "Name",
            field: "Name",
          },
          {
            title: "Lat",
            field: "Lat",
          },
          {
            title: "Lon",
            field: "Lon",
          },
          {
            title: "Temperature",
            field: "Temperature",
          },
          {
            title: "Humidity",
            field: "Humidity",
          },
        ],
      });
      $("#table").tabulator("setData", data);
    }
  </script>

<script>
  function getData() {
    // *** GET *** //
    axios
      .get("http://localhost:8080")
      .then((response) => {
        setTable(response.data);
      })
      .catch((error) => alert("Try again"));
  }
</script>

<script>
  // *** POST *** //
  function sendData() {
    axios
      .post("http://localhost:8080", {
        ID: document.getElementById("ID").value,
        Date: document.getElementById("Date").value,
        Time: document.getElementById("Time").value,
        Name: document.getElementById("Name").value,
        Lat: document.getElementById("Lat").value,
        Lon: document.getElementById("Lon").value,
        Temperature: document.getElementById("Temperature").value,
        Humidity: document.getElementById("Humidity").value,
      })
      .then((response) => { })
      .catch((error) => alert("Try again"));
  }
</script>

<script>
  // *** PUT *** //
  function updateData(idnumber) {
    var url = "http://localhost:8080/" + idenumber;
    axios
      .put(url, {
        ID: document.getElementById("ID").value,
        Date: document.getElementById("Date").value,
        Time: document.getElementById("Time").value,
        Name: document.getElementById("Name").value,
        Lat: document.getElementById("Lat").value,
        Lon: document.getElementById("Lon").value,
        Temperature: document.getElementById("Temperature").value,
        Humidity: document.getElementById("Humidity").value,
      })
      .then((response) => { })
      .catch((error) => alert("Try again"));
  } 
</script>

</head>

<body>
  <h1>Weather Station</h1>
  <p>Id<input id="id" type="text"></p>
  <p>Date<input id="date" type="text"></p>
  <p>Time<input id="time" type="text"></p>
  <p>Name<input id="placename" type="text"></p>
  <p>Lat<input id="latitude" type="text"></p>
  <p>Lon<input id="longitude" type="text"></p>
  <p>Temperature<input id="temperature" type="text"></p>
  <p>Humidity<input id="humidity" type="text"></p>
  <input type = "button" onclick = "sendData()" value = "Send Data">
</body>

</html>